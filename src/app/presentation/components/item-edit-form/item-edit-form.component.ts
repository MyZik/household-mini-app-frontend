import { Component, EventEmitter, input, OnInit, Output } from '@angular/core';
import { CommonModule } from '@angular/common';
import { CustomButtonComponent } from '../../shared/components/custom-button';
import { FormBuilder, FormGroup, ReactiveFormsModule, Validators } from '@angular/forms';

interface ItemEditData {
    itemName: string;
    itemEmoji: string;
    itemId: number;
    quantity: number;
    quantityType: string;
}

@Component({
    selector: 'app-item-edit-form',
    standalone: true,
    imports: [CommonModule, CustomButtonComponent, ReactiveFormsModule],
    templateUrl: './item-edit-form.component.html',
    styleUrl: './item-edit-form.component.less',
})
export class ItemEditFormComponent implements OnInit {
    public readonly itemData = input.required<ItemEditData>();
    @Output() confirmEdit = new EventEmitter<{ 
        id: number; 
        name: string; 
        emoji: string; 
        quantity: number;
        quantityType: string;
    }>();
    @Output() cancelEdit = new EventEmitter<void>();

    editForm: FormGroup;

    protected emojis: string[] = [
        'ğŸ',
        'ğŸ',
        'ğŸ',
        'ğŸŠ',
        'ğŸ‹',
        'ğŸŒ',
        'ğŸ‰',
        'ğŸ‡',
        'ğŸ“',
        'ğŸˆ',
        'ğŸ’',
        'ğŸ‘',
        'ğŸ¥­',
        'ğŸ',
        'ğŸ¥¥',
        'ğŸ¥',
        'ğŸ…',
        'ğŸ¥‘',
        'ğŸ†',
        'ğŸ¥”',
        'ğŸ¥•',
        'ğŸŒ½',
        'ğŸŒ¶ï¸',
        'ğŸ¥’',
        'ğŸ¥¬',
        'ğŸ¥¦',
        'ğŸ§„',
        'ğŸ§…',
        'ğŸ„',
        'ğŸ¥œ',
        'ğŸŒ°',
        'ğŸ',
        'ğŸ¥',
        'ğŸ¥–',
        'ğŸ¥¨',
        'ğŸ¥¯',
        'ğŸ¥',
        'ğŸ§‡',
        'ğŸ§€',
        'ğŸ–',
        'ğŸ—',
        'ğŸ¥©',
        'ğŸ¥“',
        'ğŸ”',
        'ğŸŸ',
        'ğŸ•',
        'ğŸŒ­',
        'ğŸ¥ª',
        'ğŸŒ®',
        'ğŸŒ¯',
        'ğŸ¥™',
        'ğŸ§†',
        'ğŸ¥š',
        'ğŸ³',
        'ğŸ¥˜',
        'ğŸ²',
        'ğŸ¥£',
        'ğŸ¥—',
        'ğŸ¿',
        'ğŸ§ˆ',
        'ğŸ§‚',
        'ğŸ¥«',
        'ğŸ±',
        'ğŸ˜',
        'ğŸ™',
        'ğŸš',
        'ğŸ›',
        'ğŸœ',
        'ğŸ',
        'ğŸ ',
        'ğŸ¢',
        'ğŸ£',
        'ğŸ¤',
        'ğŸ¥',
        'ğŸ¦',
        'ğŸ§',
        'ğŸ¨',
        'ğŸ©',
        'ğŸª',
        'ğŸ‚',
        'ğŸ°',
        'ğŸ§',
        'ğŸ¥§',
        'ğŸ«',
        'ğŸ¬',
        'ğŸ­',
        'ğŸ®',
        'ğŸ¯',
        'ğŸ¼',
        'ğŸ¥›',
        'â˜•',
        'ğŸµ',
        'ğŸ¶',
        'ğŸ¾',
        'ğŸ·',
        'ğŸ¸',
        'ğŸ¹',
        'ğŸº',
        'ğŸ»',
        'ğŸ¥‚',
        'ğŸ¥ƒ',
        'ğŸ¥¤',
        'ğŸ§ƒ',
        'ğŸ§‰',
        'ğŸ§Š',
        'ğŸ¥¢',
        'ğŸ½ï¸',
        'ğŸ´',
        'ğŸ¥„',
        'ğŸ”ª',
        'ğŸº',
        'ğŸŒ',
        'ğŸŒ',
        'ğŸŒ',
        'ğŸŒ',
        'ğŸ—ºï¸',
        'ğŸ—¾',
        'ğŸ§­',
        'ğŸ”ï¸',
        'â›°ï¸',
        'ğŸŒ‹',
        'ğŸ—»',
        'ğŸ•ï¸',
        'ğŸ–ï¸',
        'ğŸœï¸',
        'ğŸï¸',
        'ğŸï¸',
        'ğŸŸï¸',
        'ğŸ›ï¸',
        'ğŸ—ï¸',
        'ğŸ§±',
        'ğŸ˜ï¸',
        'ğŸšï¸',
        'ğŸ ',
        'ğŸ¡',
        'ğŸ¢',
        'ğŸ£',
        'ğŸ¤',
        'ğŸ¥',
        'ğŸ¦',
        'ğŸ§',
        'ğŸ¨',
        'ğŸ©',
        'ğŸª',
        'ğŸ«',
        'ğŸ¬',
        'ğŸ­',
        'ğŸ¯',
        'ğŸ°',
        'ğŸ—¼',
        'ğŸ—½',
        'â›ª',
        'ğŸ•Œ',
        'ğŸ›•',
        'ğŸ•',
        'â›©ï¸',
        'ğŸ•‹',
        'â›²',
        'â›º',
        'ğŸŒ',
        'ğŸŒƒ',
        'ğŸ™ï¸',
        'ğŸŒ„',
        'ğŸŒ…',
        'ğŸŒ†',
        'ğŸŒ‡',
        'ğŸŒ‰',
        'â™¨ï¸',
        'ğŸ ',
        'ğŸ¡',
        'ğŸ¢',
        'ğŸ’ˆ',
        'ğŸª',
        'ğŸš‚',
        'ğŸšƒ',
        'ğŸš„',
        'ğŸš…',
        'ğŸš†',
        'ğŸš‡',
        'ğŸšˆ',
        'ğŸš‰',
        'ğŸšŠ',
        'ğŸš',
        'ğŸš',
        'ğŸš‹',
        'ğŸšŒ',
        'ğŸš',
        'ğŸš',
        'ğŸš',
        'ğŸš‘',
        'ğŸš’',
        'ğŸš“',
        'ğŸš”',
        'ğŸš•',
        'ğŸš–',
        'ğŸš—',
        'ğŸš˜',
        'ğŸš™',
        'ğŸšš',
        'ğŸš›',
        'ğŸšœ',
        'ğŸï¸',
        'ğŸï¸',
        'ğŸ›µ',
        'ğŸ¦½',
        'ğŸ¦¼',
        'ğŸ›´',
        'ğŸš²',
        'ğŸ›¶',
        'â›µ',
        'ğŸš¤',
        'ğŸ›¥ï¸',
        'ğŸ›³ï¸',
        'â›´ï¸',
        'ğŸš¢',
        'âœˆï¸',
        'ğŸ›©ï¸',
        'ğŸ›«',
        'ğŸ›¬',
        'ğŸª‚',
        'ğŸ’º',
        'ğŸš',
        'ğŸšŸ',
        'ğŸš ',
        'ğŸš¡',
        'ğŸ›°ï¸',
        'ğŸš€',
        'ğŸ›¸',
        'ğŸ›ï¸',
        'ğŸ§³',
        'âŒ›',
        'â³',
        'âŒš',
        'â°',
        'â±ï¸',
        'â²ï¸',
        'ğŸ•°ï¸',
        'ğŸ•›',
        'ğŸ•§',
        'ğŸ•',
        'ğŸ•œ',
        'ğŸ•‘',
        'ğŸ•',
        'ğŸ•’',
        'ğŸ•',
        'ğŸ•“',
        'ğŸ•Ÿ',
        'ğŸ•”',
        'ğŸ• ',
        'ğŸ••',
        'ğŸ•¡',
        'ğŸ•–',
        'ğŸ•¢',
        'ğŸ•—',
        'ğŸ•£',
        'ğŸ•˜',
        'ğŸ•¤',
        'ğŸ•™',
        'ğŸ•¥',
        'ğŸ•š',
        'ğŸ•¦',
        'ğŸŒ‘',
        'ğŸŒ’',
        'ğŸŒ“',
        'ğŸŒ”',
        'ğŸŒ•',
        'ğŸŒ–',
        'ğŸŒ—',
        'ğŸŒ˜',
        'ğŸŒ™',
        'ğŸŒš',
        'ğŸŒ›',
        'ğŸŒœ',
        'ğŸŒ¡ï¸',
        'â˜€ï¸',
        'ğŸŒ',
        'ğŸŒ',
        'ğŸª',
        'â­',
        'ğŸŒŸ',
        'ğŸŒ ',
        'ğŸŒŒ',
        'â˜ï¸',
        'â›…',
        'â›ˆï¸',
        'ğŸŒ¤ï¸',
        'ğŸŒ¥ï¸',
        'ğŸŒ¦ï¸',
        'ğŸŒ§ï¸',
        'â›ˆï¸',
        'ğŸŒ©ï¸',
        'ğŸŒ¨ï¸',
        'â„ï¸',
        'â˜ƒï¸',
        'â›„',
        'ğŸŒ¬ï¸',
        'ğŸ’¨',
        'ğŸ’§',
        'ğŸ’¦',
        'â˜”',
        'â˜‚ï¸',
        'ğŸŒŠ',
        'ğŸŒˆ',
    ];

    protected unitTypes = [
        {
            label: 'StÃ¼ck',
            value: 'piece',
        },
        {
            label: 'Packung',
            value: 'package',
        },
        {
            label: 'Gramm',
            value: 'gram',
        },
        {
            label: 'Kilogramm',
            value: 'kilogram',
        },
        {
            label: 'Milliliter',
            value: 'milliliter',
        },
        {
            label: 'Liter',
            value: 'liter',
        },
    ];

    constructor(private fb: FormBuilder) {
        this.editForm = this.fb.group({
            name: ['', [Validators.required]],
            emoji: ['', [Validators.required]],
            unitType: ['', [Validators.required]],
        });
    }

    ngOnInit() {
        const data = this.itemData();
        this.editForm.patchValue({
            name: data.itemName,
            emoji: data.itemEmoji,
            unitType: data.quantityType,
        });
    }

    protected onConfirmEdit(): void {
        if (this.editForm.valid) {
            const formValue = this.editForm.value;
            const data = this.itemData();

            this.confirmEdit.emit({
                id: data.itemId,
                name: formValue.name,
                emoji: formValue.emoji,
                quantity: data.quantity,
                quantityType: formValue.unitType,
            });
        }
    }

    protected handleSubmit(): void {
        if (this.editForm.valid) {
            this.onConfirmEdit();
        }
    }

    protected onCancelEdit(): void {
        this.cancelEdit.emit();
    }
} 